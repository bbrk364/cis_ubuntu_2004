---
# tasks file for CIS Ubuntu Linux 20.04 LTS Benchmark v1.0.0 Section 2 BENCHMARKS

- name: "3.1.1 | Disable IPv6 (Manual)"
  replace:
    path: "{{ ubuntu_2004_cis_section3_rule_3_1_1_params_path }}"
    regexp: "{{ ubuntu_2004_cis_section3_rule_3_1_1_params_regex }}"
    replace: "{{ ubuntu_2004_cis_section3_rule_3_1_1_params_replace }}"
    owner: "{{ ubuntu_2004_cis_section3_rule_3_1_1_params_owner }}"
    group: "{{ ubuntu_2004_cis_section3_rule_3_1_1_params_group }}"
    mode: "{{ ubuntu_2004_cis_section3_rule_3_1_1_params_mode }}"
  notify:
    - update grub configuration
    - reapply permissions to bootloader configuration
    # ^ to handle the fact that handlers run after tasks which change bootloader config permissions
  when:
    - not ubuntu_2004_cis_require_ipv6
    - ubuntu_2004_cis_section3_rule_3_1_1
    - ubuntu_2004_cis_section3
  tags:
    - section3
    - rule_3_1_1
    - level_2

- name: "3.1.2 | Ensure wireless interfaces are disabled (Automated)"
  shell: "{{ ubuntu_2004_cis_section3_rule_3_1_2_params_shell }}"
  args:
    executable: "{{ ubuntu_2004_cis_section3_rule_3_1_2_params_executable }}"
  when:
    - not ubuntu_2004_cis_require_wireless
    - ubuntu_2004_cis_section3_rule_3_1_2
    - ubuntu_2004_cis_section3
  tags:
    - section3
    - rule_3_1_2
    - level_1
    - level_2
