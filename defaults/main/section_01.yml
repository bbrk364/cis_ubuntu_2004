---
# Default Variables for CIS UBUNTU 20.04 Benchmarks Section 1

ubuntu_2004_cis_section1_rule_1_1_1_1: true

ubuntu_2004_cis_section1_rule_1_1_1_1_params:
  source: section_01/1.1.1.1_cramfs.conf.j2
  line: install cramfs /bin/true
  dest: /etc/modprobe.d/1.1.1.1_cramfs.conf
  owner: root
  group: root
  mode: '0644'
  module_name: cramfs
  module_state: absent

ubuntu_2004_cis_section1_rule_1_1_1_2: true

ubuntu_2004_cis_section1_rule_1_1_1_2_params:
  source: section_01/1.1.1.2_freevxfs.conf.j2
  line: install freevxfs /bin/true
  dest: /etc/modprobe.d/1.1.1.2_freevxfs.conf
  owner: root
  group: root
  mode: '0644'
  module_name: freevxfs
  module_state: absent

ubuntu_2004_cis_section1_rule_1_1_1_3: true

ubuntu_2004_cis_section1_rule_1_1_1_3_params:
  source: section_01/1.1.1.3_jffs2.conf.j2
  line: install jffs2 /bin/true
  dest: /etc/modprobe.d/1.1.1.3_jffs2.conf
  owner: root
  group: root
  mode: '0644'
  module_name: jffs2
  module_state: absent

ubuntu_2004_cis_section1_rule_1_1_1_4: true

ubuntu_2004_cis_section1_rule_1_1_1_4_params:
  source: section_01/1.1.1.4_hfs.conf.j2
  line: install hfs /bin/true
  dest: /etc/modprobe.d/1.1.1.4_hfs.conf
  owner: root
  group: root
  mode: '0644'
  module_name: hfs
  module_state: absent

ubuntu_2004_cis_section1_rule_1_1_1_5: true

ubuntu_2004_cis_section1_rule_1_1_1_5_params:
  source: section_01/1.1.1.5_hfsplus.conf.j2
  line: install hfsplus /bin/true
  dest: /etc/modprobe.d/1.1.1.5_hfsplus.conf
  owner: root
  group: root
  mode: '0644'
  module_name: hfsplus
  module_state: absent

ubuntu_2004_cis_section1_rule_1_1_1_6: true

ubuntu_2004_cis_section1_rule_1_1_1_6_params:
  source: section_01/1.1.1.6_udf.conf.j2
  line: install udf /bin/true
  dest: /etc/modprobe.d/1.1.1.6_udf.conf
  owner: root
  group: root
  mode: '0644'
  module_name: udf
  module_state: absent

ubuntu_2004_cis_section1_rule_1_1_1_7: true

ubuntu_2004_cis_section1_rule_1_1_1_7_params:
  source: section_01/1.1.1.7_vfat.conf.j2
  line: install vfat /bin/true
  dest: /etc/modprobe.d/1.1.1.7_vfat.conf
  owner: root
  group: root
  mode: '0644'
  module_name: vfat
  module_state: absent

ubuntu_2004_cis_section1_rule_1_1_2: true

ubuntu_2004_cis_section1_rule_1_1_2_params:
  src: /usr/share/systemd/tmp.mount
  dest: /etc/systemd/system/tmp.mount
  owner: root
  group: root
  mode: '0644'
  backup: yes
  remote_src: yes
  force: yes

ubuntu_2004_cis_section1_rule_1_1_3: true
ubuntu_2004_cis_section1_rule_1_1_4: true
ubuntu_2004_cis_section1_rule_1_1_5: true

ubuntu_2004_cis_section1_rule_1_1_3_and_1_1_4_and_1_1_5_params:
  path: /etc/systemd/system/tmp.mount
  section: Mount
  option: Options
  value: mode=1777,strictatime,nodev,nosuid,noexec
  owner: root
  group: root
  mode: '0644'
  state: present
  backup: yes
  no_extra_spaces: yes

ubuntu_2004_cis_section1_rule_1_1_6: true
ubuntu_2004_cis_section1_rule_1_1_7: true
ubuntu_2004_cis_section1_rule_1_1_8: true
ubuntu_2004_cis_section1_rule_1_1_9: true

ubuntu_2004_cis_section1_rule_1_1_6_and_1_1_7_and_1_1_8_and_1_1_9_params:
  src: tmpfs
  path: /dev/shm
  fstype: tmpfs
  opts: defaults,noexec,nodev,nosuid,seclabel
  dump: 0
  passno: 0
  state: present
  backup: yes

ubuntu_2004_cis_section1_rule_1_1_10: true

ubuntu_2004_cis_section1_rule_1_1_11: true

ubuntu_2004_cis_section1_rule_1_1_12: true

ubuntu_2004_cis_section1_rule_1_1_13: true

ubuntu_2004_cis_section1_rule_1_1_14: true

ubuntu_2004_cis_section1_rule_1_1_15: true

ubuntu_2004_cis_section1_rule_1_1_16: true

ubuntu_2004_cis_section1_rule_1_1_17: true

ubuntu_2004_cis_section1_rule_1_1_18: true

ubuntu_2004_cis_section1_rule_1_1_19: true

ubuntu_2004_cis_section1_rule_1_1_20: true

ubuntu_2004_cis_section1_rule_1_1_21: true

ubuntu_2004_cis_section1_rule_1_1_22: true

ubuntu_2004_cis_section1_rule_1_1_22_params:
  shell: |
      set -eou pipefail;

      df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type d \( -perm -0002 -a ! -perm -1000 \) 2>/dev/null | xargs -I '{}' chmod a+t '{}'
  executable: /bin/bash

ubuntu_2004_cis_section1_rule_1_1_23: true

ubuntu_2004_cis_section1_rule_1_1_23_params:
  service_name: autofs
  daemon_reload: yes
  enabled: no
  masked: yes
  ignore_errors: yes
  package_name: autofs
  package_state: absent
  package_purge: yes

ubuntu_2004_cis_section1_rule_1_1_24: true

ubuntu_2004_cis_section1_rule_1_1_24_params:
  source: section_01/1.1.24_usb-storage.conf.j2
  line: install usb-storage /bin/true
  dest: /etc/modprobe.d/1.1.24_usb-storage.conf
  owner: root
  group: root
  mode: '0644'
  module_name: usb-storage
  module_state: absent

ubuntu_2004_cis_section1_rule_1_2_1: true

ubuntu_2004_cis_section1_rule_1_2_1_params:
  shell: |
      set -eou pipefail;

      apt-cache policy
  executable: /bin/bash
