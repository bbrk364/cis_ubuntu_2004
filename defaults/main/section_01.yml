---
# Default Variables for CIS UBUNTU 20.04 Benchmarks Section 1

ubuntu_2004_cis_section1_rule_1_1_1_1: true

ubuntu_2004_cis_section1_rule_1_1_1_1_params:
  source: section_01/1.1.1.1_cramfs.conf.j2
  line: install cramfs /bin/true
  dest: /etc/modprobe.d/1.1.1.1_cramfs.conf
  owner: root
  group: root
  mode: '0644'
  module_name: cramfs
  module_state: absent

ubuntu_2004_cis_section1_rule_1_1_1_2: true

ubuntu_2004_cis_section1_rule_1_1_1_2_params:
  source: section_01/1.1.1.2_freevxfs.conf.j2
  line: install freevxfs /bin/true
  dest: /etc/modprobe.d/1.1.1.2_freevxfs.conf
  owner: root
  group: root
  mode: '0644'
  module_name: freevxfs
  module_state: absent

ubuntu_2004_cis_section1_rule_1_1_1_3: true

ubuntu_2004_cis_section1_rule_1_1_1_3_params:
  source: section_01/1.1.1.3_jffs2.conf.j2
  line: install jffs2 /bin/true
  dest: /etc/modprobe.d/1.1.1.3_jffs2.conf
  owner: root
  group: root
  mode: '0644'
  module_name: jffs2
  module_state: absent

ubuntu_2004_cis_section1_rule_1_1_1_4: true

ubuntu_2004_cis_section1_rule_1_1_1_4_params:
  source: section_01/1.1.1.4_hfs.conf.j2
  line: install hfs /bin/true
  dest: /etc/modprobe.d/1.1.1.4_hfs.conf
  owner: root
  group: root
  mode: '0644'
  module_name: hfs
  module_state: absent

ubuntu_2004_cis_section1_rule_1_1_1_5: true

ubuntu_2004_cis_section1_rule_1_1_1_5_params:
  source: section_01/1.1.1.5_hfsplus.conf.j2
  line: install hfsplus /bin/true
  dest: /etc/modprobe.d/1.1.1.5_hfsplus.conf
  owner: root
  group: root
  mode: '0644'
  module_name: hfsplus
  module_state: absent

ubuntu_2004_cis_section1_rule_1_1_1_6: true

ubuntu_2004_cis_section1_rule_1_1_1_6_params:
  source: section_01/1.1.1.6_udf.conf.j2
  line: install udf /bin/true
  dest: /etc/modprobe.d/1.1.1.6_udf.conf
  owner: root
  group: root
  mode: '0644'
  module_name: udf
  module_state: absent

ubuntu_2004_cis_section1_rule_1_1_1_7: true

ubuntu_2004_cis_section1_rule_1_1_1_7_params:
  source: section_01/1.1.1.7_vfat.conf.j2
  line: install vfat /bin/true
  dest: /etc/modprobe.d/1.1.1.7_vfat.conf
  owner: root
  group: root
  mode: '0644'
  module_name: vfat
  module_state: absent

ubuntu_2004_cis_section1_rule_1_1_2: true

ubuntu_2004_cis_section1_rule_1_1_2_params:
  src: /usr/share/systemd/tmp.mount
  dest: /etc/systemd/system/tmp.mount
  owner: root
  group: root
  mode: '0644'
  backup: yes
  remote_src: yes
  force: yes

ubuntu_2004_cis_section1_rule_1_1_3: true
ubuntu_2004_cis_section1_rule_1_1_4: true
ubuntu_2004_cis_section1_rule_1_1_5: true

ubuntu_2004_cis_section1_rule_1_1_3_and_1_1_4_and_1_1_5_params:
  path: /etc/systemd/system/tmp.mount
  section: Mount
  option: Options
  value: mode=1777,strictatime,nodev,nosuid,noexec
  owner: root
  group: root
  mode: '0644'
  state: present
  backup: yes
  no_extra_spaces: yes

ubuntu_2004_cis_section1_rule_1_1_6: true
ubuntu_2004_cis_section1_rule_1_1_7: true
ubuntu_2004_cis_section1_rule_1_1_8: true
ubuntu_2004_cis_section1_rule_1_1_9: true

ubuntu_2004_cis_section1_rule_1_1_6_and_1_1_7_and_1_1_8_and_1_1_9_params:
  src: tmpfs
  path: /dev/shm
  fstype: tmpfs
  opts: defaults,noexec,nodev,nosuid,seclabel
  dump: 0
  passno: 0
  state: present
  backup: yes

ubuntu_2004_cis_section1_rule_1_1_10: true

ubuntu_2004_cis_section1_rule_1_1_11: true

ubuntu_2004_cis_section1_rule_1_1_12: true

ubuntu_2004_cis_section1_rule_1_1_13: true

ubuntu_2004_cis_section1_rule_1_1_14: true

ubuntu_2004_cis_section1_rule_1_1_15: true

ubuntu_2004_cis_section1_rule_1_1_16: true

ubuntu_2004_cis_section1_rule_1_1_17: true

ubuntu_2004_cis_section1_rule_1_1_18: true

ubuntu_2004_cis_section1_rule_1_1_19: true

ubuntu_2004_cis_section1_rule_1_1_20: true

ubuntu_2004_cis_section1_rule_1_1_21: true

ubuntu_2004_cis_section1_rule_1_1_22: true

ubuntu_2004_cis_section1_rule_1_1_22_params:
  shell: |
      set -eou pipefail;

      df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type d \( -perm -0002 -a ! -perm -1000 \) 2>/dev/null | xargs -I '{}' chmod a+t '{}'
  executable: /bin/bash

ubuntu_2004_cis_section1_rule_1_1_23: true

ubuntu_2004_cis_section1_rule_1_1_23_params:
  service_name: autofs
  daemon_reload: yes
  enabled: no
  masked: yes
  ignore_errors: yes
  package_name: autofs
  package_state: absent
  package_purge: yes

ubuntu_2004_cis_section1_rule_1_1_24: true

ubuntu_2004_cis_section1_rule_1_1_24_params:
  source: section_01/1.1.24_usb-storage.conf.j2
  line: install usb-storage /bin/true
  dest: /etc/modprobe.d/1.1.24_usb-storage.conf
  owner: root
  group: root
  mode: '0644'
  module_name: usb-storage
  module_state: absent

ubuntu_2004_cis_section1_rule_1_2_1: true

ubuntu_2004_cis_section1_rule_1_2_1_params:
  shell: |
      set -eou pipefail;

      apt-cache policy
  executable: /bin/bash

ubuntu_2004_cis_section1_rule_1_2_2: true

ubuntu_2004_cis_section1_rule_1_2_2_params:
  shell: |
      set -eou pipefail;

      apt-key list
  executable: /bin/bash

ubuntu_2004_cis_section1_rule_1_3_1: true

ubuntu_2004_cis_section1_rule_1_3_1_params:
  package_name: sudo
  package_state: present

ubuntu_2004_cis_section1_rule_1_3_2: true

ubuntu_2004_cis_section1_rule_1_3_2_params:
  path: /etc/sudoers
  line: Defaults use_pty
  regexp: ^Defaults.*use_pty
  state: present
  owner: root
  group: root
  mode: '0640'
  validate: visudo -cf %s

ubuntu_2004_cis_section1_rule_1_3_3: true

ubuntu_2004_cis_section1_rule_1_3_3_params:
  path: /etc/sudoers
  line: Defaults logfile="/var/log/sudo.log"
  regexp: ^Defaults.*logfile
  state: present
  owner: root
  group: root
  mode: '0640'
  validate: visudo -cf %s

ubuntu_2004_cis_section1_rule_1_4_1: true

ubuntu_2004_cis_section1_rule_1_4_1_params:
  package_name:
    - aide
    - aide-common
  package_state: present
  db_file_name: /var/lib/aide/aide.db
  db_file_init_command: aideinit

ubuntu_2004_cis_section1_rule_1_4_2: true

ubuntu_2004_cis_section1_rule_1_4_2_params:
  name: "1.4.2 Ensure filesystem integrity is regularly checked | AIDE CRON ENTRY"
  minute: 0
  hour: 5
  day: '*'
  month: '*'
  weekday: '*'
  user: root
  job: '/usr/bin/aide.wrapper --config /etc/aide/aide.conf --check'

ubuntu_2004_cis_section1_rule_1_5_1: true

ubuntu_2004_cis_section1_rule_1_5_1_set_superuser: true
ubuntu_2004_cis_section1_rule_1_5_1_password_pbkdf2: true
ubuntu_2004_cis_section1_rule_1_5_1_unrestricted: true

ubuntu_2004_cis_section1_rule_1_5_1_params:
  set_superusers_path: /etc/grub.d/40_custom
  set_superusers_line: set superusers="root"
  set_superusers_regexp: ^set.*superusers
  set_superusers_state: present
  set_superusers_owner: root
  set_superusers_group: root
  set_superusers_mode: '0755'
  bootloader_password_executable: /bin/bash
  bootloader_password_path: /etc/grub.d/40_custom
  bootloader_password_regexp: ^password_pbkdf2.*root
  bootloader_password_state: present
  bootloader_password_owner: root
  bootloader_password_group: root
  bootloader_password_mode: '0755'
  bootloader_password_insertafter: '^set superusers="root"'
  unrestricted_path: /etc/grub.d/10_linux
  unrestricted_regex: '^CLASS="(((?!--unrestricted).)*)"$'
  unrestricted_replace: 'CLASS="\1 --unrestricted"'
  unrestricted_owner: root
  unrestricted_group: root
  unrestricted_mode: '0755'

ubuntu_2004_cis_section1_rule_1_5_2: true

ubuntu_2004_cis_section1_rule_1_5_2_params:
  path: /boot/grub/grub.cfg
  mode: '0400'
  owner: root
  group: root
  state: file

ubuntu_2004_cis_section1_rule_1_5_3: true

ubuntu_2004_cis_section1_rule_1_5_3_params:
  audit_root_password_command: 'grep ^root:[*\!]: /etc/shadow'
  audit_root_password_executable: /bin/bash

ubuntu_2004_cis_section1_rule_1_6_1: true

ubuntu_2004_cis_section1_rule_1_6_1_params:
  audit_xd_nx_command: "grep ^flags /proc/cpuinfo | head -n1 | grep -E 'pae|nx'"
  audit_root_password_executable: /bin/bash

ubuntu_2004_cis_section1_rule_1_6_2: true

ubuntu_2004_cis_section1_rule_1_6_2_params:
  name: kernel.randomize_va_space
  value: '2'
  state: present
  reload: yes
  sysctl_set: yes

ubuntu_2004_cis_section1_rule_1_6_3: true

ubuntu_2004_cis_section1_rule_1_6_3_params:
  prelink_command: 'prelink -ua'
  package_name: prelink
  package_state: absent
  package_purge: yes


ubuntu_2004_cis_section1_rule_1_6_4: true

ubuntu_2004_cis_section1_rule_1_6_4_params:
  core_dump_security_limit_path: /etc/security/limits.conf
  core_dump_security_limit_line: '* hard core 0'
  core_dump_security_limit_regexp: .*\*.*hard.*core.*[0-9]
  core_dump_security_limit_state: present
  core_dump_security_limit_owner: root
  core_dump_security_limit_group: root
  core_dump_security_limit_mode: '0644'
  core_dump_kernel_parameter_name: fs.suid_dumpable
  core_dump_kernel_parameter_value: '0'
  core_dump_kernel_parameter_state: present
  core_dump_kernel_parameter_reload: yes
  core_dump_kernel_parameter_sysctl_set: yes
  core_dump_package_name: systemd-coredump
  core_dump_package_state: present
  core_dump_service_conf_path: /etc/systemd/coredump.conf
  core_dump_service_conf_section: Coredump
  core_dump_service_conf_storage_option: Storage
  core_dump_service_conf_storage_value: none
  core_dump_service_conf_processsizemax_option: ProcessSizeMax
  core_dump_service_conf_processsizemax_value: 0
  core_dump_service_conf_owner: root
  core_dump_service_conf_group: root
  core_dump_service_conf_mode: '0644'
  core_dump_service_conf_state: present
  core_dump_service_conf_no_extra_spaces: yes
