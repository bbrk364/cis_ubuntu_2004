---
# Default Variables for CIS Ubuntu Linux 20.04 LTS Benchmark v1.0.0 Section 3

# Variables for 3.1.1
ubuntu_2004_cis_section3_rule_3_1_1: true

ubuntu_2004_cis_section3_rule_3_1_1_params_path: /etc/default/grub
ubuntu_2004_cis_section3_rule_3_1_1_params_regex: '^GRUB_CMDLINE_LINUX="(((?!ipv6.disable=1).)*)"$'
ubuntu_2004_cis_section3_rule_3_1_1_params_replace: 'GRUB_CMDLINE_LINUX="\1 ipv6.disable=1"'
ubuntu_2004_cis_section3_rule_3_1_1_params_owner: root
ubuntu_2004_cis_section3_rule_3_1_1_params_group: root
ubuntu_2004_cis_section3_rule_3_1_1_params_mode: '0644'

# Variables for 3.1.2
ubuntu_2004_cis_section3_rule_3_1_2: true
ubuntu_2004_cis_require_wireless: false

ubuntu_2004_cis_section3_rule_3_1_2_params_shell: |
      set -eou pipefail;

      if [ -n "$(find /sys/class/net/*/ -type d -name wireless)" ];
      then
        drivers=$(for driverdir in $(find /sys/class/net/*/ -type d -name wireless | xargs -0 dirname); do basename "$(readlink -f "$driverdir"/device/driver)";done | sort -u)
        for dm in $drivers;
        do
          echo "install $dm /bin/true" >> /etc/modprobe.d/3.1.2_disable_wireless.conf
        done
      fi
ubuntu_2004_cis_section3_rule_3_1_2_params_executable: /bin/bash

# Variables for 3.2.1
ubuntu_2004_cis_section3_rule_3_2_1: true

ubuntu_2004_cis_section3_rule_3_2_1_params_all_send_redirects: net.ipv4.conf.all.send_redirects
ubuntu_2004_cis_section3_rule_3_2_1_params_all_send_redirects_value: '0'
ubuntu_2004_cis_section3_rule_3_2_1_params_default_send_redirects: net.ipv4.conf.default.send_redirects
ubuntu_2004_cis_section3_rule_3_2_1_params_default_send_redirects_value: '0'
ubuntu_2004_cis_section3_rule_3_2_1_params_state: present
ubuntu_2004_cis_section3_rule_3_2_1_params_reload: yes
ubuntu_2004_cis_section3_rule_3_2_1_params_sysctl_set: yes

# Variables for 3.2.2
ubuntu_2004_cis_section3_rule_3_2_2: true

ubuntu_2004_cis_section3_rule_3_2_2_params_ipv4_forwarding: net.ipv4.ip_forward
ubuntu_2004_cis_section3_rule_3_2_2_params_ipv4_forwarding_value: '0'
ubuntu_2004_cis_section3_rule_3_2_2_params_ipv6_forwarding: net.ipv6.conf.all.forwarding
ubuntu_2004_cis_section3_rule_3_2_2_params_ipv6_forwarding_value: '0'
ubuntu_2004_cis_section3_rule_3_2_2_params_state: present
ubuntu_2004_cis_section3_rule_3_2_2_params_reload: yes
ubuntu_2004_cis_section3_rule_3_2_2_params_sysctl_set: yes

# Variables for 3.3.1
ubuntu_2004_cis_section3_rule_3_3_1: true

ubuntu_2004_cis_section3_rule_3_3_1_params_ipv4all_accept_source_route: net.ipv4.conf.all.accept_source_route
ubuntu_2004_cis_section3_rule_3_3_1_params_ipv4all_accept_source_route_value: '0'
ubuntu_2004_cis_section3_rule_3_3_1_params_ipv4default_accept_source_route: net.ipv4.conf.default.accept_source_route
ubuntu_2004_cis_section3_rule_3_3_1_params_ipv4default_accept_source_route_value: '0'
ubuntu_2004_cis_section3_rule_3_3_1_params_ipv6all_accept_source_route: net.ipv6.conf.all.accept_source_route
ubuntu_2004_cis_section3_rule_3_3_1_params_ipv6all_accept_source_route_value: '0'
ubuntu_2004_cis_section3_rule_3_3_1_params_ipv6default_accept_source_route: net.ipv6.conf.default.accept_source_route
ubuntu_2004_cis_section3_rule_3_3_1_params_ipv6default_accept_source_route_value: '0'
ubuntu_2004_cis_section3_rule_3_3_1_params_state: present
ubuntu_2004_cis_section3_rule_3_3_1_params_reload: yes
ubuntu_2004_cis_section3_rule_3_3_1_params_sysctl_set: yes

# Variables for 3.3.2
ubuntu_2004_cis_section3_rule_3_3_2: true

ubuntu_2004_cis_section3_rule_3_3_2_params_ipv4all_accept_redirects: net.ipv4.conf.all.accept_redirects
ubuntu_2004_cis_section3_rule_3_3_2_params_ipv4all_accept_redirects_value: '0'
ubuntu_2004_cis_section3_rule_3_3_2_params_ipv4default_accept_redirects: net.ipv4.conf.default.accept_redirects
ubuntu_2004_cis_section3_rule_3_3_2_params_ipv4default_accept_redirects_value: '0'
ubuntu_2004_cis_section3_rule_3_3_2_params_ipv6all_accept_redirects: net.ipv6.conf.all.accept_redirects
ubuntu_2004_cis_section3_rule_3_3_2_params_ipv6all_accept_redirects_value: '0'
ubuntu_2004_cis_section3_rule_3_3_2_params_ipv6default_accept_redirects: net.ipv6.conf.default.accept_redirects
ubuntu_2004_cis_section3_rule_3_3_2_params_ipv6default_accept_redirects_value: '0'
ubuntu_2004_cis_section3_rule_3_3_2_params_state: present
ubuntu_2004_cis_section3_rule_3_3_2_params_reload: yes
ubuntu_2004_cis_section3_rule_3_3_2_params_sysctl_set: yes

# Variables for 3.3.3
ubuntu_2004_cis_section3_rule_3_3_3: true

ubuntu_2004_cis_section3_rule_3_3_3_params_ipv4all_secure_redirects: net.ipv4.conf.all.secure_redirects
ubuntu_2004_cis_section3_rule_3_3_3_params_ipv4all_secure_redirects_value: '0'
ubuntu_2004_cis_section3_rule_3_3_3_params_ipv4default_secure_redirects: net.ipv4.conf.default.secure_redirects
ubuntu_2004_cis_section3_rule_3_3_3_params_ipv4default_secure_redirects_value: '0'
ubuntu_2004_cis_section3_rule_3_3_3_params_state: present
ubuntu_2004_cis_section3_rule_3_3_3_params_reload: yes
ubuntu_2004_cis_section3_rule_3_3_3_params_sysctl_set: yes

# Variables for 3.3.4
ubuntu_2004_cis_section3_rule_3_3_4: true

ubuntu_2004_cis_section3_rule_3_3_4_params_ipv4all_log_martians: net.ipv4.conf.all.log_martians
ubuntu_2004_cis_section3_rule_3_3_4_params_ipv4all_log_martians_value: '0'
ubuntu_2004_cis_section3_rule_3_3_4_params_ipv4default_log_martians: net.ipv4.conf.default.log_martians
ubuntu_2004_cis_section3_rule_3_3_4_params_ipv4default_log_martians_value: '0'
ubuntu_2004_cis_section3_rule_3_3_4_params_state: present
ubuntu_2004_cis_section3_rule_3_3_4_params_reload: yes
ubuntu_2004_cis_section3_rule_3_3_4_params_sysctl_set: yes

# Variables for 3.3.5
ubuntu_2004_cis_section3_rule_3_3_5: true

ubuntu_2004_cis_section3_rule_3_3_5_params_ipv4_ignore_broadcasts: net.ipv4.icmp_echo_ignore_broadcasts
ubuntu_2004_cis_section3_rule_3_3_5_params_ipv4_ignore_broadcasts_value: '1'
ubuntu_2004_cis_section3_rule_3_3_5_params_state: present
ubuntu_2004_cis_section3_rule_3_3_5_params_reload: yes
ubuntu_2004_cis_section3_rule_3_3_5_params_sysctl_set: yes

# Variables for 3.3.6
ubuntu_2004_cis_section3_rule_3_3_6: true

ubuntu_2004_cis_section3_rule_3_3_6_params_ipv4_ignore_bogus_error_responses: net.ipv4.icmp_ignore_bogus_error_responses
ubuntu_2004_cis_section3_rule_3_3_6_params_ipv4_ignore_bogus_error_responses_value: '1'
ubuntu_2004_cis_section3_rule_3_3_6_params_state: present
ubuntu_2004_cis_section3_rule_3_3_6_params_reload: yes
ubuntu_2004_cis_section3_rule_3_3_6_params_sysctl_set: yes

# Variables for 3.3.7
ubuntu_2004_cis_section3_rule_3_3_7: true

ubuntu_2004_cis_section3_rule_3_3_7_params_ipv4all_rp_filter: net.ipv4.conf.all.rp_filter
ubuntu_2004_cis_section3_rule_3_3_7_params_ipv4all_rp_filter_value: '1'
ubuntu_2004_cis_section3_rule_3_3_7_params_ipv4default_rp_filter: net.ipv4.conf.default.rp_filter
ubuntu_2004_cis_section3_rule_3_3_7_params_ipv4default_rp_filter_value: '1'
ubuntu_2004_cis_section3_rule_3_3_7_params_state: present
ubuntu_2004_cis_section3_rule_3_3_7_params_reload: yes
ubuntu_2004_cis_section3_rule_3_3_7_params_sysctl_set: yes
