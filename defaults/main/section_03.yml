---
# Default Variables for CIS Ubuntu Linux 20.04 LTS Benchmark v1.0.0 Section 3

# Variables for 3.1.1
ubuntu_2004_cis_section3_rule_3_1_1: true

ubuntu_2004_cis_section3_rule_3_1_1_params_path: /etc/default/grub
ubuntu_2004_cis_section3_rule_3_1_1_params_regex: '^GRUB_CMDLINE_LINUX="(((?!ipv6.disable=1).)*)"$'
ubuntu_2004_cis_section3_rule_3_1_1_params_replace: 'GRUB_CMDLINE_LINUX="\1 ipv6.disable=1"'
ubuntu_2004_cis_section3_rule_3_1_1_params_owner: root
ubuntu_2004_cis_section3_rule_3_1_1_params_group: root
ubuntu_2004_cis_section3_rule_3_1_1_params_mode: '0644'

# Variables for 3.1.2
ubuntu_2004_cis_section3_rule_3_1_2: true
ubuntu_2004_cis_require_wireless: false

ubuntu_2004_cis_section3_rule_3_1_2_params_shell: |
      set -eou pipefail;

      if [ -n "$(find /sys/class/net/*/ -type d -name wireless)" ];
      then
        drivers=$(for driverdir in $(find /sys/class/net/*/ -type d -name wireless | xargs -0 dirname); do basename "$(readlink -f "$driverdir"/device/driver)";done | sort -u)
        for dm in $drivers;
        do
          echo "install $dm /bin/true" >> /etc/modprobe.d/3.1.2_disable_wireless.conf
        done
      fi
ubuntu_2004_cis_section3_rule_3_1_2_params_executable: /bin/bash

# Variables for 3.2.1
ubuntu_2004_cis_section3_rule_3_2_1: true

ubuntu_2004_cis_section3_rule_3_2_1_params_all_send_redirects: net.ipv4.conf.all.send_redirects
ubuntu_2004_cis_section3_rule_3_2_1_params_all_send_redirects_value: '0'
ubuntu_2004_cis_section3_rule_3_2_1_params_default_send_redirects: net.ipv4.conf.default.send_redirects
ubuntu_2004_cis_section3_rule_3_2_1_params_default_send_redirects_value: '0'
ubuntu_2004_cis_section3_rule_3_2_1_params_state: present
ubuntu_2004_cis_section3_rule_3_2_1_params_reload: yes
ubuntu_2004_cis_section3_rule_3_2_1_params_sysctl_set: yes

# Variables for 3.2.2
ubuntu_2004_cis_section3_rule_3_2_2: true

ubuntu_2004_cis_section3_rule_3_2_2_params_ipv4_forwarding: net.ipv4.ip_forward
ubuntu_2004_cis_section3_rule_3_2_2_params_ipv4_forwarding_value: '0'
ubuntu_2004_cis_section3_rule_3_2_2_params_ipv6_forwarding: net.ipv6.conf.all.forwarding
ubuntu_2004_cis_section3_rule_3_2_2_params_ipv6_forwarding_value: '0'
ubuntu_2004_cis_section3_rule_3_2_2_params_state: present
ubuntu_2004_cis_section3_rule_3_2_2_params_reload: yes
ubuntu_2004_cis_section3_rule_3_2_2_params_sysctl_set: yes

# Variables for 3.3.1
ubuntu_2004_cis_section3_rule_3_3_1: true

ubuntu_2004_cis_section3_rule_3_3_1_params_ipv4all_accept_source_route: net.ipv4.conf.all.accept_source_route
ubuntu_2004_cis_section3_rule_3_3_1_params_ipv4all_accept_source_route_value: '0'
ubuntu_2004_cis_section3_rule_3_3_1_params_ipv4default_accept_source_route: net.ipv4.conf.default.accept_source_route
ubuntu_2004_cis_section3_rule_3_3_1_params_ipv4default_accept_source_route_value: '0'
ubuntu_2004_cis_section3_rule_3_3_1_params_ipv6all_accept_source_route: net.ipv6.conf.all.accept_source_route
ubuntu_2004_cis_section3_rule_3_3_1_params_ipv6all_accept_source_route_value: '0'
ubuntu_2004_cis_section3_rule_3_3_1_params_ipv6default_accept_source_route: net.ipv6.conf.default.accept_source_route
ubuntu_2004_cis_section3_rule_3_3_1_params_ipv6default_accept_source_route_value: '0'
ubuntu_2004_cis_section3_rule_3_3_1_params_state: present
ubuntu_2004_cis_section3_rule_3_3_1_params_reload: yes
ubuntu_2004_cis_section3_rule_3_3_1_params_sysctl_set: yes
